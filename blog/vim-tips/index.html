<!doctype html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="@byodian"><meta name="description" content="vim tips"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@byodian"><meta name="twitter:creator" content="@byodian"><meta property="og:title" content="vim tips"><meta property="og:type" content="website"><meta property="og:url" content=""><meta property="og:description" content="vim tips"><meta property="og:image" content="https://byodiandev.com/static/img/avatar-3x.png"><link rel="icon" type="image/icon" href="/static/img/favicon.ico"><link rel="stylesheet" href="/index.css"><style></style><title>vim tips</title></head><body><div id="root" class="container max-w-4xl mx-auto px-6 pt-4"><header class="mt-16 mb-8"><p><a class="font-bold" href="/">byodian's blog</a></p></header><div class="pb-5 mb-5 border-b border-gray-100"><h1 class="text-5xl">vim tips</h1><p class="text-gray-400"><time datetime="2022年7月19日">发布于2022年7月19日</time> · <time datetime="2024年5月3日">更新于2024年5月3日</time></p></div><article class="prose lg:prose-lg"><h2>Replace</h2><pre class="language-bash"><code class="language-bash">:%s/https<span class="token punctuation">\</span>?.*/<span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">)</span>/g</code></pre><ul><li><code>%</code> – set the range to the entire file</li><li><code>s</code> – substitution</li><li><code>/https\?.*/</code> – regex to match <code>http</code> or <code>https</code> and anything else after it</li><li><code>[&amp;](&amp;)</code>– The <code>&amp;</code> is the magic here and inserts the matched text. In this case, the URL. The rest of the characters are interpreted literally, giving us the linked URL in the resulting markdown.</li><li><code>/g</code> changes all the matches on a line</li><li>use any regex delimiter in your pattern substitution. No need to use <code>/</code> at all, try <code>#</code> instead: <code>:s#/usr/local/bin#/usr/sbin#g</code> to avoid escaping slashes.</li><li>Limit a search and replace operation between lines matching 2 regex patterns using <code>/pattern1/,/pattern2/s/search/replace/</code></li></ul><p><a href="https://www.notion.so/Search-and-replace-Vim-Tips-Wiki-Fandom-51a0f65baf324e00bbcc06f0691fd7ca">Search and replace | Vim Tips Wiki | Fandom</a></p><h3>Repeat the last substitution</h3><p>Developing efficient workflows in Vim is all about repetition, first and foremost by using <code>.</code> to repeat the last command. But Vim can also repeat your last substitution. Here’s a few options with subtle differences:</p><ul><li><code>:&amp;</code> – Repeats last substitution but resets the flags. Also works with just :s.</li><li><code>:&amp;&amp;</code> – Repeat last substitution with the same flags.</li><li><code>:%&amp;</code> – Repeat last substitution on entire file, reset flags.</li><li><code>:%&amp;&amp;</code> – Repeat last substitution on entire file, keep flags.</li></ul><pre class="language-bash"><code class="language-bash">:%s/something/newthing/g<br>:%<span class="token operator">&amp;</span>g</code></pre><h2>Search</h2><ul><li>Append <code>/e</code> to the end of a search to place the cursor at the end of the next match. I.e <code>/patten/e</code></li><li>Stay in search mode <code>/pattern&lt;C-g&gt;</code> or <code>/pattern&lt;C-t&gt;</code></li><li>Append <code>\C</code> to the end of a search to enable a case-sensitive search. Examples:<ul><li><code>/copyright</code> - case insensitive</li><li><code>/Copyright</code> - case sensitive</li><li><code>/copyright\C</code> - case sensitive</li><li><code>/Copyright\c</code> - case insensitive</li></ul></li></ul><h2><a href="https://vim.fandom.com/wiki/Power_of_g">Power of g</a></h2><p>The global command <code>:g</code> is very useful - multiple repeats</p><pre class="language-json"><code class="language-json"><span class="token operator">:</span><span class="token punctuation">[</span>range<span class="token punctuation">]</span>g<span class="token punctuation">[</span>lobal<span class="token punctuation">]</span>/<span class="token punctuation">{</span>pattern<span class="token punctuation">}</span>/<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span></code></pre><p>For example:</p><ul><li><p><code>:g/pattern/d</code> – Remove lines matching pattern</p></li><li><p><code>:3,4g/pattern/d</code> – Remove lines matching pattern between 3 and 4 line</p></li><li><p><code>:g/pattern/y A</code> - Yank all lines matching ‘pattern’ into the register.</p></li><li><p><code>:g!/pattern/d</code> – Remove lines that do NOT match the pattern</p></li><li><p><code>:v/pattern/d</code> – Also removes lines that do not match the pattern</p></li><li><p><code>:cdo g/function/norm! ciw func&lt;cr&gt;</code></p></li><li><p><code>gQ</code></p></li><li><p><code>g0</code></p></li><li><p><code>g$</code></p></li><li><p><code>g &lt;ctrl-g&gt;</code></p></li><li><p><code>g &lt;ctrl-a&gt;</code></p></li><li><p><code>g#</code></p></li><li><p><code>g&amp;</code></p></li><li><p><code>g-</code></p></li><li><p><code>g+</code></p></li><li><p><code>g??</code></p></li><li><p><code>gI</code></p></li><li><p><code>gU</code></p></li><li><p><code>gt</code></p></li><li><p><code>gT</code></p></li><li><p><code>g_</code></p></li><li><p><code>gf</code></p></li><li><p><code>gd</code></p></li><li><p><code>gg</code></p></li></ul><h2>Copying and pasting lines</h2><ul><li><p>The slow way is to navigate to the line I want, yank it, go back and paste it.</p></li><li><p>The most efficient way I can think to do that is to jump by searching with <code>/</code> and pressing <code>&lt;CR&gt;</code>. Then <strong>yank</strong> the line with <code>yy</code>. Then use the jump list, <code>&lt;ctrl-o&gt;</code>, to bounce back. And press <code>p</code> to paste the line below or <code>P</code> to paste the line above.</p></li><li><p>Use the ex <code>:yank</code> command <code>:&lt;line number&gt;yank</code> – copies the line number specified to your default register.</p></li><li><p>Use the ex <code>:copy</code> command <code>:&lt;line number&gt;copy.</code> – copies the line number specified and pastes it to the line below</p></li><li><p>The ex <code>:copy</code> command has a short version <code>t</code></p><ul><li><code>:281t.</code> – Copy line 281 and paste it below <strong>the current line</strong></li><li><code>:-10t.</code> – Copy the line 10 lines above the current line and paste it below <strong>the current line</strong></li><li><code>:+8t.</code> – Copy the line 8 lines after <strong>the current line</strong> and paste it below</li><li><code>:10,20t.</code> – Copy lines 10 to 20 and paste them <strong>below</strong></li><li><code>:t20</code> – Copy the current line and paste it <strong>below line 20</strong></li></ul></li><li><p>Pasting into Vim from @StackOverflow? Avoid indent fail by using set <code>:paste</code> or use the system clipboard with <code>&quot;*p</code></p><p><a href="https://vimtricks.com/p/vimtricks-avoid-paste-formatting">https://vimtricks.com/p/vimtricks-avoid-paste-formatting</a></p></li><li><p>To select a register from which to paste, one can use <code>&quot;{register}p</code> to paste from the register <code>{register}</code>. See <a href="https://vim.fandom.com/wiki/Pasting_registers">pasting registers</a>.</p></li></ul><h2>The shortcut keyboards in insert mode</h2><ul><li><code>&lt;c-w&gt;</code> - delete a word</li><li><code>&lt;c-x&gt;&lt;C-f&gt;</code> - autocomplete filenames in vim.</li><li><code>&lt;c-n&gt;</code> - 自动提示</li><li><code>&lt;c-p&gt;</code> - 自动提示</li><li><code>&lt;c-r&gt;=</code> - From insert mode, enters Vim’s expression register</li><li><code>&lt;c-f&gt;</code> - switch from Command-Line mode to the command-line window. Or During the <code>/</code> portion of a search, open a search history window.</li><li><code>&lt;c-a&gt;</code> or <code>&lt;C-x&gt;</code> - increment or decrement hex, binary, and octal numbers in normal mode.</li><li><code>&lt;c-k&gt;</code> + 2 letters - add special characters in insert mode. see mode <code>:help dig</code>. Examples:<ul><li><code>&lt;c-k&gt;oo</code> • bullet</li><li><code>&lt;c-k&gt;Db</code> ◆ diamond bullet</li><li><code>&lt;c-k&gt;Pd</code> £ pound</li><li><code>&lt;c-k&gt;Eu</code> € euro</li><li><code>&lt;c-k&gt;-N</code> – en dash</li><li><code>&lt;c-k&gt;-M</code> — em</li></ul></li></ul><h2>Quickfix</h2><p>what a quick fix list is effectively what a quick fix list is a series of entries in which point to a specific file and location.</p><p>A lot of times they’re associated with errors links or search results.</p><ul><li>quickfix<ul><li><code>:cw</code> 错误信息分屏显示</li><li><code>:cp</code> 跳到上一个错误</li><li><code>:cl</code> 列出所有错误</li><li><code>:cc</code> 显示错误详细信息</li><li><code>:cdo</code></li></ul></li><li>location-list <code>:ldo</code></li></ul><h2>DOS 与 Linux 的换行符</h2><p>字符转换命令</p><ul><li><code>dos2unix [-kn] file [newfile]</code></li><li><code>unix2dos [-kn] file [newfile]</code></li></ul><h2>The undo tree usr_32.txt</h2><ul><li>If you make changes, undo, then make a different change, then undo, then make a different change, you create undo branches.</li><li>To view the change tree, run <code>:undolist</code>, to navigate the undo branches, use <code>g-</code>, <code>g+</code></li><li>Go back to an earlier text state with the <code>:earlier</code> command.</li><li>Go to newer text state with the <code>:later</code> command. This command accepts the following time units: <code>s</code> (seconds), <code>h</code> (hours), <code>d</code> (days), and <code>f</code> (number of saves).</li></ul><h2>Change the case of characters with <code>~</code>, <code>u</code> and <code>U</code>.</h2><ul><li><code>gUw</code> - Uppercase to end of word</li><li><code>gUiw</code> - Uppercase entire word</li><li><code>guap</code> - Lowercase paragraph</li></ul><h2>Sort lines in Vim:</h2><p><a href="https://github.com/christoomey/vim-sort-motion">sort-motion plugin</a> - The primary interface to this plugin is via the <code>gs</code> mapping, for sorting based on a text object or motion.</p><p>Examples:</p><ul><li><code>gs2j</code> =&gt; Sort down two lines (current + 2 below)</li><li><code>gsip</code> =&gt; Sort the current paragraph</li><li><code>gsii</code> =&gt; Sort the current indentation level (requires <a href="https://github.com/kana/vim-textobj-indent">text-obj-indent plugin</a>)</li><li><code>gsi(</code> =&gt; Sort within parenthesis. <code>(b, c, a)</code> would become <code>(a, b, c)</code></li></ul><p>Vim has some built in options</p><ul><li><code>:sort</code> - sort all lines</li><li><code>:sort!</code> - sort in reverse</li><li><code>:sort u</code> - remove dupes and sort</li><li><code>:sort i</code> - ignore case</li><li><code>:sort n</code> - sort numerically</li></ul><p>There are ways to sort elements of a single line in vanilla vim as well, as detailed in this <a href="https://vi.stackexchange.com/questions/17532/is-there-an-efficient-way-to-sort-a-selection-of-comma-separated-values-in-a-sin/17538#17538">StackExchange response</a>, but they will involve some regex.</p><h2>jump between changes</h2><ul><li><code>:changes</code> - Show list of changes</li><li><code>g;</code> - Jump to previous</li><li><code>g,</code> - Jump to next</li></ul><h2>:norm</h2><p>The command allows you to execute normal mode operations from the command line. By combining with <code>%</code> , we can run a sequence of operations on an entire file.</p><ul><li><code>:%norm</code> - Run a normal mode command on the entire file.</li><li><code>ysiw</code> - <a href="https://github.com/tpope/vim-surround">surround plugin</a></li><li><code>:%norm ysiw&quot;A: &quot;&quot;</code></li></ul><h2>` character</h2><ul><li><code>`[</code> - Navigate to the beginning of your most recently <strong>yanked</strong> or <strong>changed</strong> text</li><li><code>`]</code> - Navigate to the end of your most recently <strong>yanked</strong> or <strong>changed</strong> text</li></ul><h2>Ex Command-line</h2><ul><li><code>:set noignorecase</code> - make searches case sensitive (the default)</li><li><code>:set hlsearch</code> - highlight the remaining matches with the search highlight group.</li><li><code>:set splitright</code> - open splits in a right direction.</li><li><code>:set splitbelow</code> - open splits in a below direction.</li><li><code>:set laststatus=3</code> - show only one activeted single status bar</li><li><code>:edit!</code> - revert (go back or return to) all changes to the current buffer.</li><li><code>:1,5j</code> - Use the ex command <code>j</code> to join some lines on a range. Use visual selection, and J to join or 'gJ' to join without spacing</li><li>Use <code>%:h</code> to get the path part of the current file. i.e., <code>cd %:h</code> to set the working directory to the directory of the current file.</li><li>Use <code>:reg</code> to view the contents of all registers, or <code>:reg{register}</code> to view the contents of one.</li><li><code>:Man</code> command - Open that command's man page</li><li><code>:dig</code> - open a list of all digraphs available on your system (complication options can affect the list)</li><li><code>:reg</code> - open the vim registers</li><li>Toggle Vim boolean options<ul><li>adding a bang <code>!</code> at the end. <code>:set number!</code>, <code>:set cusorcolumn!</code></li><li><code>:set number</code> will turn the feature on</li><li><code>:set nonumber</code> will turn the feature off</li></ul></li><li>Check the current state of any option by adding a question mark <code>?</code> to the end: <code>:set number?</code> will return either <code>number</code> or <code>nonumber</code> depending on if the option is on or off.</li><li>Repeat the history command<ul><li>Enter command mode <code>:</code> and then press <code>&lt;C-p&gt;</code> to cycle back through your history, finding a command and invoking it again.</li><li>if the command was the last colon command you ran, simply press <code>@:</code> to repeat the last command.j</li></ul></li><li>Delete using the <code>&quot;_d{motion}</code> command to delete without overwriting your default register.</li><li><a href="https://vimtricks.com/p/vimtrick-non-printable-characters/">Non-printable Characters</a> <code>^M</code> is a single character inserted by using <code>CTRL-v</code> followed by <code>CTRL-m</code>. <a href="https://www.w3schools.com/charsets/ref_utf_latin1_supplement.asp">UTF-8 C1 Controls and Latin1 Supplement</a></li></ul><h2>Others</h2><ol><li><p>You can edit your visual selection by using <code>o</code> to bounce your cursor to the opposite end of the selection. Adjust the top bound as needed, then press <code>o</code> to return to the bottom.</p></li><li><p>Use <code>gv</code> in Vim to reselect the last visual selection</p></li><li><p><a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#filename-modifiers">filename-modifiers</a>。<a href="https://www.codenong.com/1708623">关于Unix：在Vim中打开与当前文件相同的文件夹中的文件</a></p><p><code>:p</code> Make file name a full path, <code>:h expand</code>, <code>:wildcards</code></p></li><li><p>Use <code>ea</code> to append to the end of the current word.</p></li><li><p>Swap two characters in Vim with <code>xp</code></p></li><li><p>Put from the <code>&quot;%p</code> register to put the name of the current file.</p></li><li><p>To make it easier to navigate conflict markers, you could tweak the built-in matchit plugin: <a href="http://stackoverflow.com/a/71676129/853%E2%80%A6">stackoverflow.com/a/71676129/853…</a></p></li><li><p>Multiple cursor support</p></li><li><p>Open the quickfix window with <code>:cwin</code> and see the results. Next we do another search. To get back to our previous, older quickfix window, we use <code>:colder</code>. Then, we can return to the most recent search results with <code>:cnewer</code>.</p></li><li><p>To find out what’s stored in each register, simply use Vim’s <code>:registers</code> command, or <code>:reg</code> for short.</p></li><li><p>Use <code>m{capital letter}</code> to make a global mark. Close and reopen VIm, and press <code>'{capital letter}</code> to open the file w/ the global mark.</p></li><li><p>使用命令 <code>:mksession ~/.mysession.vim</code> ( <code>:mks</code> is ok) 保存已经打开的多窗口文件。 如果文件重复，vim 默认会报错，使用 <code>:mksession! ~/.mysession.vim</code> 代替。在终端输入命令 <code>vim -S ~/.mysession.vim</code> 打开保存的会话。</p></li><li><p><code>.</code> 小数点可以重复上一次的命令</p></li><li><p><code>N&lt;command&gt;</code> 重复某个命令 N 次</p></li><li><p>args</p><ul><li><code>:args /path/*</code></li><li><code>:wn</code></li></ul></li></ol><p><a href="https://vimtricks.com/p/vimtrick-edit-files-sequentially/">https://vimtricks.com/p/vimtrick-edit-files-sequentially/</a> - Edit files sequentially</p><h2>Helps</h2><ul><li><code>:help wildoptions</code> - command-line completion allows fuzzy-matching in some cases</li><li><code>:help registers</code> - <code>&quot;0p</code> will paste from the <code>0</code> register, which automatically contains the last yanked text.</li><li><code>:help global</code></li><li><code>:help no-greedy</code> - because <code>.*</code> is <em>greedy</em>. It matches the maximum amount of text it can. <code>.\{-}</code> will match the fewest characters possible to make a match.</li><li><code>:help jumplist</code> - jumps are cursor movements stored in a list called the jumplist. movements which modify the jump list are:<ul><li><code>/pattern</code> searches and <code>?pattern</code>searches (forward and backward pattern matching)</li><li><code>*</code> and <code>#</code> (forward and backward search for the word under the cursor.</li><li><code>%</code> (jump to a matching enclosing character like paren, brace, bracket, etc)</li><li>Any inter-file navigation like <code>gf</code></li></ul></li><li><code>:help scroll-cursor</code></li><li><code>:help option-list</code> - all vim options</li><li><code>:help usr&lt;tab&gt;</code></li><li><code>:help buffer</code></li><li><code>:help window</code></li><li><code>:help &lt;tab&gt;</code></li><li><code>:help split</code></li><li><code>:help motion</code></li><li><code>:help options</code></li><li><code>:help &lt;tabcomplate or ctrl-d&gt;</code></li><li><code>:help &lt;specific option name&gt;</code></li><li><code>:help quickfix</code></li><li><code>:help macros</code></li><li><code>:help motions</code></li><li><code>:help substitude</code></li><li><code>:help g</code></li></ul></article><footer class="mb-2"><p>byodian's blog</p></footer></div><script src="/index.js"></script><script src="https://kit.fontawesome.com/d101a7035d.js" crossorigin="anonymous"></script></body></html>